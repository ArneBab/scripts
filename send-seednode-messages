#!/bin/bash
cat seednodes-failed.mbox | (grep "RESULT:.*NOT CONNECTED IN LAST WEEK" | cut -d " "  -f 1 | cut -d ":" -f 2) | (while read x; do grep --files-with-match -e "$x" seedrefs/*; done) | (while read x; do mv "$x" /home/toad/seedrefs-broken/ ; echo "$x"; echo "$x" > /dev/tty; done) | sed "s/^seedrefs\///g" | sed -n "s/^.*---//p" | (while read x; do (echo "To: " $x; echo "From: toad@amphibian.dyndns.org"; echo "Subject: Your Freenet seednode"; echo; echo "Your freenet seednode has not connected in the last week. Please fix this and then send me your new noderef. This is often caused by your IP address changing. Thanks. This is an automated message, I will read any replies, it is sent because you asked for your seednode to be added to the official list and it is no longer contactable."; echo ".") | /usr/sbin/sendmail "$x"; done)
